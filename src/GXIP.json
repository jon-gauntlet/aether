{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": [
    "finding_id",
    "source",
    "title",
    "description",
    "severity",
    "security_category",
    "risk_score"
  ],
  "properties": {
    "finding_id": {
      "type": "string",
      "description": "Unique identifier for the finding"
    },
    "source": {
      "type": "string",
      "enum": ["sast", "dast", "claude-3.5-sonnet"],
      "description": "Source of the finding"
    },
    "title": {
      "type": "string",
      "description": "Brief title describing the finding"
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the finding"
    },
    "severity": {
      "type": "string",
      "enum": ["critical", "high", "medium", "low", "info"],
      "description": "Severity level of the finding"
    },
    "security_category": {
      "type": "string",
      "enum": [
        "1. Sessions",
        "2. Sessions",
        "3. Cross-Site Request Forgery (CSRF)",
        "4. Redirection and Files",
        "5. User Management",
        "6. Injection",
        "7. Unsafe Query Generation",
        "8. HTTP Security Headers",
        "9. Intranet and Admin Security",
        "10. Environmental Security",
        "11. Dependency Management and CVEs"
      ],
      "description": "Security category from Rails Security Guide"
    },
    "risk_score": {
      "type": "object",
      "required": ["score", "likelihood_factors", "impact_factors"],
      "properties": {
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10,
          "description": "Final OWASP risk score (0-10)"
        },
        "likelihood_factors": {
          "type": "object",
          "properties": {
            "threat_agent": {
              "type": "number",
              "description": "Threat agent factor score"
            },
            "vulnerability": {
              "type": "number",
              "description": "Vulnerability factor score"
            }
          }
        },
        "impact_factors": {
          "type": "object",
          "properties": {
            "technical": {
              "type": "number",
              "description": "Technical impact score"
            },
            "business": {
              "type": "number",
              "description": "Business impact score"
            }
          }
        },
        "justification": {
          "type": "string",
          "description": "Explanation of risk score factors"
        }
      }
    },
    "recommendations": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of recommended actions to remediate the finding"
    },
    "location": {
      "type": "object",
      "properties": {
        "file": {
          "type": "string"
        },
        "line": {
          "type": "integer"
        }
      }
    },
    "evidence": {
      "type": "object",
      "properties": {
        "reproduction": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "proof_of_concept": {
          "type": "string"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional tool-specific metadata"
    }
  }
} 