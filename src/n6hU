#!/bin/bash

# Safe Dual Claude Launcher
# Launches two cursor instances with different contexts without modifying the core binary

set -euo pipefail

# Paths
CURSOR_CONFIG="/home/jon/.config/cursor"
CURSOR_SHARE="/home/jon/.local/share/cursor"
PROJECT_PATH="/home/jon/projects/aether"
AI_SYSTEM_PATH="/home/jon/ai_system_evolution"

# Ensure base directories exist
mkdir -p "$CURSOR_SHARE/run" "$CURSOR_CONFIG/contexts"

# Launch system Claude for AI system evolution
CURSOR_CONTEXT_TYPE="system" \
CURSOR_WORKSPACE="$AI_SYSTEM_PATH" \
CURSOR_SLICE="cursor-claude-system.slice" \
cursor "$AI_SYSTEM_PATH" &

# Wait a bit to prevent race conditions
sleep 2

# Launch project Claude for Aether
CURSOR_CONTEXT_TYPE="project" \
CURSOR_WORKSPACE="$PROJECT_PATH" \
CURSOR_SLICE="cursor-claude-project.slice" \
cursor "$PROJECT_PATH" &

# Wait for both to start
wait 