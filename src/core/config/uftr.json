{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": [
    "id",
    "source",
    "title",
    "description",
    "severity",
    "security_category"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the finding"
    },
    "source": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["sast", "dast", "claude-3.5-sonnet"],
          "description": "Source type of the finding"
        },
        "tool": {
          "type": "string",
          "description": "Name of the tool that generated the finding"
        },
        "original_id": {
          "type": "string",
          "description": "Original ID from the source tool"
        }
      }
    },
    "title": {
      "type": "string",
      "description": "Brief title describing the finding"
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the finding"
    },
    "severity": {
      "type": "string",
      "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW", "INFO"],
      "description": "Severity level of the finding"
    },
    "security_category": {
      "type": "string",
      "enum": [
        "1. Sessions",
        "2. Sessions",
        "3. Cross-Site Request Forgery (CSRF)",
        "4. Redirection and Files",
        "5. User Management",
        "6. Injection",
        "7. XSS",
        "8. HTTP Security Headers",
        "9. Intranet and Admin Security",
        "10. Environmental Security",
        "11. Dependency Management and CVEs"
      ],
      "description": "Security category from Rails Security Guide"
    },
    "finding_type": {
      "type": "string",
      "enum": ["vulnerable_code", "configuration", "dependency", "design"],
      "description": "Type of the finding"
    },
    "evidence": {
      "type": "object",
      "properties": {
        "reproduction": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "file": {
          "type": "string"
        },
        "proof_of_concept": {
          "type": "string"
        }
      }
    },
    "remediation": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of recommended actions to remediate the finding"
    },
    "references": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "url": {
            "type": "string"
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional tool-specific metadata"
    },
    "owasp_risk_factors": {
      "type": "object",
      "required": ["likelihood", "impact", "overall_score"],
      "properties": {
        "likelihood": {
          "type": "object",
          "required": ["score", "factors"],
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 10
            },
            "factors": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "impact": {
          "type": "object",
          "required": ["score", "factors"],
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 10
            },
            "factors": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "overall_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10
        }
      }
    }
  }
} 